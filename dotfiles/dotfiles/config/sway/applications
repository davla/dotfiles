# {{@@ header() @@}}
#
# This sway configuration file contains application configuration, mainly
# keyboard shortcuts and window management (e.g. workspace assignment)

#######################################
# Variables
#######################################

{%@@ set messaging_client = 'teams'
    if env['HOST'] == 'work'
    else 'telegram' -@@%}

# Command criteria
set $android_studio_criterion app_id="jetbrains-studio"
set $firefox_criterion app_id=".*Firefox.*"
set $scratchpad_editor_criterion instance="scratchpad-editor"
set $scratchpad_term_criterion title="scratchpad-terminal"
set $spotify_criterion app_id="spotify"
set $teams_criterion instance=".*microsoft teams.*"
set $telegram_criterion app_id="telegramdesktop" title="Telegram.*"
set $thunderbird_criterion app_id="thunderbird"
set $vscode_criterion app_id="^code.*"

# Application instance titles
set $calc_title calculator

#######################################
# Shortcuts
#######################################

bindsym $mod+Shift+e exec $term --title $calc_title -e lua
bindsym $mod+space exec i3-dmenu-desktop
bindsym $mod+Shift+space exec dmenu_run
bindsym $mod+w exec firefox
bindsym $mod+Shift+y exec geany
bindsym $mod+y exec --no-startup-id i3-start-or-scratchpad \
    'geany --name scratchpad-editor' '--classname scratchpad-editor' \
    '$scratchpad_editor_criterion'
bindsym $mod+Escape exec --no-startup-id halt -p
bindsym $mod+e exec --no-startup-id i3-start-or-scratchpad \
    '{{@@ messaging_client @@}}' '--classname {{@@ messaging_client @@}}' \
    '${{@@ messaging_client @@}}_criterion'
bindsym $mod+F5 exec --no-startup-id reboot
bindsym $mod+Tab exec $term
bindsym $mod+Shift+Tab exec --no-startup-id i3-start-or-scratchpad \
    '$term --title scratchpad-terminal' '--name scratchpad-terminal' \
    '$scratchpad_term_criterion'
bindsym $mod+u exec thunar
bindsym $mod+p exec --no-startup-id i3-start-or-scratchpad 'spotify' \
    '--classname spotify' '$spotify_criterion'

{%@@ if env['HOST'] == 'personal' -@@%}

bindsym $mod+o exec firefox https://calendar.google.com/calendar/r
bindsym $mod+i exec firefox https://keep.google.com/#home
bindsym $mod+t exec thunderbird

{%@@ endif -@@%}

#######################################
# Windows
#######################################

# Variables
set $floating_width 900
set $floating_height 550

# Assigning applications to workspaces
assign [$android_studio_criterion] $ws1
assign [$vscode_criterion] $ws1
assign [$firefox_criterion] $ws2
assign [$thunderbird_criterion] $ws4

# Switch to assigned workspace by focusing newly created windows
for_window [$android_studio_criterion] focus
for_window [$firefox_criterion] $ws2
for_window [$thunderbird_criterion] $ws4
for_window [$vscode_criterion] focus

# Android studio splash
for_window [$android_studio_criterion title="win0" workspace=$ws1] \
    floating enable

# Calculator
for_window [title="$calc_title"] floating enable
for_window [floating title="$calc_title"] \
    resize set $floating_width $floating_height, \
    move position center

# Scratchpad editor
for_window [$scratchpad_editor_criterion] floating enable
for_window [floating $scratchpad_editor_criterion] \
    resize set 1000 850, move position center

# Scratchpad terminal
for_window [$scratchpad_term_criterion] floating enable
for_window [floating $scratchpad_term_criterion] \
    resize set $floating_width $floating_height, \
    move position center

# Spotify
for_window [$spotify_criterion] floating enable
for_window [floating $spotify_criterion] \
    resize set 1500 850, move position center

# Teams
for_window [$teams_criterion] floating enable
for_window [floating $teams_criterion window_type="normal"] \
    resize set 1200 950, move position center

# Telegram
for_window [$telegram_criterion] floating enable
for_window [floating $telegram_criterion] \
    resize set 900 800, move position center

#######################################
# Application startup
#######################################

# Autostart
exec --no-startup-id dex -ae sway

# Startup terminal
exec --no-startup-id swaymsg 'workspace $ws3; exec $term'
